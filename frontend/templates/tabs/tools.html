<div x-show="activeTab === 'tools'" :style="activeTab === 'tools' ? 'display:block' : 'display:none'" id="tools-tab"
    role="tabpanel" aria-labelledby="tools-tab-btn" tabindex="0">

    <div class="grid-3-col">
        <!-- DNS Lookup Tool -->
        <div class="card">
            <h2>
                <div class="card-title-content">
                    <span>DNS Lookup</span>
                </div>
                <div class="card-actions">
                    <div class="spinner" x-show="tools.dns.loading"></div>
                </div>
            </h2>
            <div class="widget-body">
                <p class="text-muted mb-3">Resolve and inspect DNS records</p>
                <div class="tool-input-group">
                    <input type="text" x-model="tools.dns.query" placeholder="Domain or IP (e.g., google.com)"
                        class="tool-input" @keydown.enter="runDnsLookup()" aria-label="DNS query domain or IP">
                    <select x-model="tools.dns.type" class="tool-select" aria-label="DNS record type">
                        <option value="A">A</option>
                        <option value="AAAA">AAAA</option>
                        <option value="MX">MX</option>
                        <option value="TXT">TXT</option>
                        <option value="NS">NS</option>
                        <option value="PTR">PTR</option>
                    </select>
                    <button class="btn btn--secondary" @click="runDnsLookup()"
                        :disabled="!tools.dns.query || tools.dns.loading">
                        Query
                    </button>
                </div>
                <div x-show="tools.dns.error" class="tool-error" x-text="tools.dns.error"></div>
                <div x-show="tools.dns.result" class="tool-result">
                    <pre x-text="tools.dns.result"></pre>
                </div>
            </div>
        </div>

        <!-- Port Check Tool -->
        <div class="card">
            <h2>
                <div class="card-title-content">
                    <span>Port Check</span>
                </div>
                <div class="card-actions">
                    <div class="spinner" x-show="tools.port.loading"></div>
                </div>
            </h2>
            <div class="widget-body">
                <p class="text-muted mb-3">Test service reachability on specific ports</p>
                <div class="tool-input-group">
                    <input type="text" x-model="tools.port.host" placeholder="Host (e.g., 192.168.1.1)"
                        class="tool-input" @keydown.enter="runPortCheck()" aria-label="Target host">
                    <input type="text" x-model="tools.port.ports" placeholder="Ports (e.g., 22,80,443)"
                        class="tool-input-sm" @keydown.enter="runPortCheck()" aria-label="Target ports">
                    <button class="btn btn--secondary" @click="runPortCheck()"
                        :disabled="!tools.port.host || !tools.port.ports || tools.port.loading">
                        Check
                    </button>
                </div>
                <div x-show="tools.port.error" class="tool-error" x-text="tools.port.error"></div>
                <div x-show="tools.port.result" class="tool-result">
                    <template x-for="port in tools.port.result" :key="port.port">
                        <div class="port-result-row">
                            <span class="port-number" x-text="port.port"></span>
                            <span class="port-status" :class="port.open ? 'status-open' : 'status-closed'"
                                x-text="port.open ? 'OPEN' : 'CLOSED'"></span>
                            <span class="port-service" x-text="port.service || ''"></span>
                        </div>
                    </template>
                </div>
            </div>
        </div>

        <!-- Ping / Traceroute Tool -->
        <div class="card">
            <h2>
                <div class="card-title-content">
                    <span>Ping / Traceroute</span>
                </div>
                <div class="card-actions">
                    <div class="spinner" x-show="tools.ping.loading"></div>
                </div>
            </h2>
            <div class="widget-body">
                <p class="text-muted mb-3">Reachability and path testing</p>
                <div class="tool-input-group">
                    <input type="text" x-model="tools.ping.host" placeholder="Host (e.g., 8.8.8.8)" class="tool-input"
                        @keydown.enter="runPing()" aria-label="Target host">
                    <select x-model="tools.ping.mode" class="tool-select" aria-label="Tool mode">
                        <option value="ping">Ping</option>
                        <option value="traceroute">Traceroute</option>
                    </select>
                    <button class="btn btn--secondary" @click="runPing()"
                        :disabled="!tools.ping.host || tools.ping.loading">
                        Run
                    </button>
                </div>
                <div x-show="tools.ping.error" class="tool-error" x-text="tools.ping.error"></div>
                <div x-show="tools.ping.result" class="tool-result">
                    <pre x-text="tools.ping.result"></pre>
                </div>
            </div>
        </div>

        <!-- Whois / ASN Lookup Tool -->
        <div class="card">
            <h2>
                <div class="card-title-content">
                    <span>Whois / ASN Lookup</span>
                </div>
                <div class="card-actions">
                    <div class="spinner" x-show="tools.whois.loading"></div>
                </div>
            </h2>
            <div class="widget-body">
                <p class="text-muted mb-3">Network ownership and geographic origin</p>
                <div class="tool-input-group">
                    <input type="text" x-model="tools.whois.query" placeholder="IP or domain" class="tool-input"
                        @keydown.enter="runWhoisLookup()" aria-label="Whois query">
                    <button class="btn btn--secondary" @click="runWhoisLookup()"
                        :disabled="!tools.whois.query || tools.whois.loading">
                        Lookup
                    </button>
                </div>
                <div x-show="tools.whois.error" class="tool-error" x-text="tools.whois.error"></div>
                <div x-show="tools.whois.result" class="tool-result">
                    <div class="whois-result">
                        <div><strong>ASN:</strong> <span x-text="tools.whois.result?.asn || 'N/A'"></span></div>
                        <div><strong>Organization:</strong> <span x-text="tools.whois.result?.org || 'N/A'"></span>
                        </div>
                        <div><strong>Country:</strong> <span x-text="tools.whois.result?.country || 'N/A'"></span></div>
                        <div><strong>Network:</strong> <span x-text="tools.whois.result?.network || 'N/A'"></span></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- HTTP Probe Tool -->
        <div class="card">
            <h2>
                <div class="card-title-content">
                    <span>HTTP Probe</span>
                </div>
                <div class="card-actions">
                    <div class="spinner" x-show="tools.httpProbe.loading"></div>
                </div>
            </h2>
            <div class="widget-body">
                <p class="text-muted mb-3">Check status, latency, and response headers</p>
                <div class="tool-input-group">
                    <input type="text" x-model="tools.httpProbe.url" placeholder="URL (e.g., https://example.com)"
                        class="tool-input" @keydown.enter="runHttpProbe()" aria-label="Target URL">
                    <button class="btn btn--secondary" @click="runHttpProbe()"
                        :disabled="!tools.httpProbe.url || tools.httpProbe.loading">
                        Probe
                    </button>
                </div>
                <div x-show="tools.httpProbe.error" class="tool-error" x-text="tools.httpProbe.error"></div>
                <div x-show="tools.httpProbe.result" class="tool-result">
                    <div class="tool-result-list">
                        <div><strong>Status:</strong> <span x-text="tools.httpProbe.result?.status_code || '-'"></span>
                        </div>
                        <div><strong>Latency:</strong> <span
                                x-text="tools.httpProbe.result?.elapsed_ms !== null && tools.httpProbe.result?.elapsed_ms !== undefined ? tools.httpProbe.result.elapsed_ms + ' ms' : '-'"></span>
                        </div>
                        <div><strong>Final URL:</strong> <span x-text="tools.httpProbe.result?.final_url || '-'"></span>
                        </div>
                    </div>
                    <template
                        x-if="tools.httpProbe.result?.redirect_chain && tools.httpProbe.result.redirect_chain.length">
                        <div style="margin-top: var(--space-2);">
                            <div class="text-muted"
                                style="font-size: var(--fs-xs); text-transform: uppercase; letter-spacing: 0.08em;">
                                Redirects</div>
                            <div class="tool-result-list">
                                <template x-for="(hop, idx) in tools.httpProbe.result.redirect_chain" :key="idx">
                                    <div x-text="hop.status + ' -> ' + hop.url"></div>
                                </template>
                            </div>
                        </div>
                    </template>
                    <template x-if="tools.httpProbe.result?.headers">
                        <div style="margin-top: var(--space-2);">
                            <div class="text-muted"
                                style="font-size: var(--fs-xs); text-transform: uppercase; letter-spacing: 0.08em;">
                                Headers</div>
                            <pre x-text="JSON.stringify(tools.httpProbe.result.headers, null, 2)"></pre>
                        </div>
                    </template>
                </div>
            </div>
        </div>

        <!-- TLS Certificate Tool -->
        <div class="card">
            <h2>
                <div class="card-title-content">
                    <span>TLS Certificate</span>
                </div>
                <div class="card-actions">
                    <div class="spinner" x-show="tools.tlsInspect.loading"></div>
                </div>
            </h2>
            <div class="widget-body">
                <p class="text-muted mb-3">Inspect certificate issuer, expiry, and SANs</p>
                <div class="tool-input-group">
                    <input type="text" x-model="tools.tlsInspect.host" placeholder="Host (e.g., example.com)"
                        class="tool-input" @keydown.enter="runTlsInspect()" aria-label="Target host">
                    <input type="text" x-model="tools.tlsInspect.port" placeholder="443" class="tool-input-sm"
                        @keydown.enter="runTlsInspect()" aria-label="Target port">
                    <button class="btn btn--secondary" @click="runTlsInspect()"
                        :disabled="!tools.tlsInspect.host || tools.tlsInspect.loading">
                        Inspect
                    </button>
                </div>
                <div x-show="tools.tlsInspect.error" class="tool-error" x-text="tools.tlsInspect.error"></div>
                <div x-show="tools.tlsInspect.result" class="tool-result">
                    <div class="tool-result-list">
                        <div><strong>Subject:</strong> <span x-text="tools.tlsInspect.result?.subject_cn || '-'"></span>
                        </div>
                        <div><strong>Issuer:</strong> <span x-text="tools.tlsInspect.result?.issuer_cn || '-'"></span>
                        </div>
                        <div><strong>Valid From:</strong> <span
                                x-text="tools.tlsInspect.result?.not_before || '-'"></span></div>
                        <div><strong>Valid To:</strong> <span x-text="tools.tlsInspect.result?.not_after || '-'"></span>
                        </div>
                        <div><strong>Days Remaining:</strong> <span
                                x-text="tools.tlsInspect.result?.days_remaining !== null && tools.tlsInspect.result?.days_remaining !== undefined ? tools.tlsInspect.result.days_remaining : '-'"></span>
                        </div>
                        <div><strong>TLS:</strong> <span x-text="tools.tlsInspect.result?.tls_version || '-'"></span>
                        </div>
                        <div><strong>Cipher:</strong> <span x-text="tools.tlsInspect.result?.cipher || '-'"></span>
                        </div>
                    </div>
                    <template x-if="tools.tlsInspect.result?.san && tools.tlsInspect.result.san.length">
                        <div style="margin-top: var(--space-2);">
                            <div class="text-muted"
                                style="font-size: var(--fs-xs); text-transform: uppercase; letter-spacing: 0.08em;">
                                SAN</div>
                            <div class="tool-result-list">
                                <template x-for="(name, idx) in tools.tlsInspect.result.san" :key="idx">
                                    <div x-text="name"></div>
                                </template>
                            </div>
                        </div>
                    </template>
                </div>
            </div>
        </div>
    </div>

</div>