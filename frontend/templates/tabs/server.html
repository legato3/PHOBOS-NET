<div x-show="activeTab === 'server'" :style="activeTab === 'server' ? 'display:block' : 'display:none'" id="server-tab"
    role="tabpanel" aria-labelledby="server-tab-btn" tabindex="0">
    <section id="section-server" class="scroll-section" style="margin-bottom: 32px;">
        <!-- Loading State -->
        <template x-if="serverHealth.loading">
            <div class="empty-state">
                <span>Loading server health data...</span>
            </div>
        </template>

        <!-- Error State -->
        <template x-if="serverHealth.error && !serverHealth.loading">
            <div class="empty-state" style="color: var(--neon-red);">
                <span x-text="serverHealth.error"></span>
            </div>
        </template>

        <!-- Server Health Content - Reorganized into 4 Primary Widgets -->
        <template x-if="!serverHealth.loading && !serverHealth.error">
            <div class="grid"
                style="grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 24px;">

                <!-- 1. System Health (Composite) -->
                <div x-data="{ expanded: false }" x-show="serverHealth.cpu || serverHealth.memory || serverHealth.disk">
                    {% set health_badge %}
                    <span class="server-stat-badge" :class="{
                                            'badge-success': (serverHealth.cpu?.percent || 0) < 70 && (serverHealth.memory?.percent || 0) < 80 && (serverHealth.disk?.root?.percent_used || 0) < 80,
                                            'badge-warning': (serverHealth.cpu?.percent || 0) >= 70 || (serverHealth.memory?.percent || 0) >= 80 || (serverHealth.disk?.root?.percent_used || 0) >= 80,
                                            'badge-error': (serverHealth.cpu?.percent || 0) >= 90 || (serverHealth.memory?.percent || 0) >= 90 || (serverHealth.disk?.root?.percent_used || 0) >= 90
                                        }">HEALTHY</span>
                    {% endset %}
                    <div class="card">
                        <h2>
                            <div class="card-title-content">
                                <span class="title-icon">üíö</span>
                                <span>System Health</span>
                            </div>
                            <div class="card-actions">
                                {{ health_badge | safe }}
                            </div>
                        </h2>
                        <div class="widget-body" style="min-height: 300px;">
                            <div x-show="!serverHealth.loading">
                                <div class="server-stat-value" style="font-size: 1.1em;">
                                    <span x-show="serverHealth.cpu && serverHealth.cpu.percent !== undefined">
                                        CPU: <span :class="{
                                                    'text-green': serverHealth.cpu.percent < 70,
                                                    'text-yellow': serverHealth.cpu.percent >= 70 && serverHealth.cpu.percent < 90,
                                                    'text-red': serverHealth.cpu.percent >= 90
                                                }" x-text="serverHealth.cpu.percent + '%'"></span>
                                    </span>
                                    <span x-show="serverHealth.memory && serverHealth.memory.percent !== undefined"
                                        style="margin-left: 12px;">
                                        MEM: <span :class="{
                                                    'text-green': serverHealth.memory.percent < 80,
                                                    'text-yellow': serverHealth.memory.percent >= 80 && serverHealth.memory.percent < 90,
                                                    'text-red': serverHealth.memory.percent >= 90
                                                }" x-text="serverHealth.memory.percent + '%'"></span>
                                    </span>
                                    <span
                                        x-show="serverHealth.disk && serverHealth.disk.root && serverHealth.disk.root.percent_used !== undefined"
                                        style="margin-left: 12px;">
                                        DISK: <span :class="{
                                                    'text-green': serverHealth.disk.root.percent_used < 80,
                                                    'text-yellow': serverHealth.disk.root.percent_used >= 80 && serverHealth.disk.root.percent_used < 90,
                                                    'text-red': serverHealth.disk.root.percent_used >= 90
                                                }" x-text="serverHealth.disk.root.percent_used + '%'"></span>
                                    </span>
                                </div>
                                <button @click="expanded = !expanded"
                                    style="margin-top: 12px; padding: 6px 12px; background: rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; color: var(--text-secondary); cursor: pointer; font-size: 0.85em;">
                                    <span x-text="expanded ? '‚ñº Hide Details' : '‚ñ∂ Show Details'"></span>
                                </button>
                                <div x-show="expanded" x-collapse
                                    style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255,255,255,0.1);">
                                    <div class="server-stat-details">
                                        <div x-show="serverHealth.system && serverHealth.system.hostname">
                                            <span>Hostname:</span>
                                            <span x-text="serverHealth.system.hostname"></span>
                                        </div>
                                        <div x-show="serverHealth.system && serverHealth.system.uptime_formatted">
                                            <span>Uptime:</span>
                                            <span x-text="serverHealth.system.uptime_formatted"></span>
                                        </div>
                                        <div x-show="serverHealth.timestamp">
                                            <span>Last Update:</span>
                                            <span
                                                x-text="serverHealth.timestamp ? new Date(serverHealth.timestamp).toLocaleString() : 'N/A'"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 2. CPU & Memory -->
                <div x-data="{ expanded: false }"
                    x-show="(serverHealth.cpu && !serverHealth.cpu.error) || (serverHealth.memory && !serverHealth.memory.error)">
                    {% set cpu_mem_badge %}
                    <span class="server-stat-badge" :class="{
                                            'badge-success': (serverHealth.cpu?.percent || 0) < 70 && (serverHealth.memory?.percent || 0) < 80,
                                            'badge-warning': (serverHealth.cpu?.percent || 0) >= 70 || (serverHealth.memory?.percent || 0) >= 80,
                                            'badge-error': (serverHealth.cpu?.percent || 0) >= 90 || (serverHealth.memory?.percent || 0) >= 90
                                        }">OK</span>
                    {% endset %}
                    <div class="card">
                        <h2>
                            <div class="card-title-content">
                                <span class="title-icon">‚ö°üíæ</span>
                                <span>CPU & Memory</span>
                            </div>
                            <div class="card-actions">
                                {{ cpu_mem_badge | safe }}
                            </div>
                        </h2>
                        <div class="widget-body" style="min-height: 300px;">
                            <div x-show="!serverHealth.loading">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                    <!-- CPU Summary -->
                                    <div x-show="serverHealth.cpu && !serverHealth.cpu.error">
                                        <div
                                            style="font-size: 0.85em; color: var(--text-secondary); margin-bottom: 4px;">
                                            CPU</div>
                                        <div class="server-stat-value"
                                            x-text="serverHealth.cpu.percent ? serverHealth.cpu.percent + '%' : 'N/A'">
                                        </div>
                                        <div class="server-stat-progress"
                                            x-show="serverHealth.cpu.percent !== undefined">
                                            <div class="server-stat-progress-bar" :class="{
                                                        'warning': serverHealth.cpu.percent >= 70 && serverHealth.cpu.percent < 90,
                                                        'error': serverHealth.cpu.percent >= 90
                                                    }" :style="'width: ' + (serverHealth.cpu.percent || 0) + '%'">
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Memory Summary -->
                                    <div x-show="serverHealth.memory && !serverHealth.memory.error">
                                        <div
                                            style="font-size: 0.85em; color: var(--text-secondary); margin-bottom: 4px;">
                                            Memory</div>
                                        <div class="server-stat-value"
                                            x-text="serverHealth.memory.percent ? serverHealth.memory.percent + '%' : 'N/A'">
                                        </div>
                                        <div class="server-stat-progress"
                                            x-show="serverHealth.memory.percent !== undefined">
                                            <div class="server-stat-progress-bar" :class="{
                                                        'warning': serverHealth.memory.percent >= 80 && serverHealth.memory.percent < 90,
                                                        'error': serverHealth.memory.percent >= 90
                                                    }" :style="'width: ' + (serverHealth.memory.percent || 0) + '%'">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <button @click="expanded = !expanded"
                                    style="margin-top: 12px; padding: 6px 12px; background: rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; color: var(--text-secondary); cursor: pointer; font-size: 0.85em;">
                                    <span x-text="expanded ? '‚ñº Hide Details' : '‚ñ∂ Show Details'"></span>
                                </button>
                                <div x-show="expanded" x-collapse
                                    style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255,255,255,0.1);">
                                    <!-- CPU Details -->
                                    <div class="server-stat-details"
                                        x-show="serverHealth.cpu && serverHealth.cpu.load_1min">
                                        <div style="font-weight: 600; margin-bottom: 8px; color: var(--text-primary);">
                                            CPU Details</div>
                                        <div>
                                            <span>Load 1m:</span>
                                            <span x-text="serverHealth.cpu.load_1min"></span>
                                        </div>
                                        <div>
                                            <span>Load 5m:</span>
                                            <span x-text="serverHealth.cpu.load_5min"></span>
                                        </div>
                                        <div>
                                            <span>Load 15m:</span>
                                            <span x-text="serverHealth.cpu.load_15min"></span>
                                        </div>
                                        <div x-show="serverHealth.cpu.frequency_mhz">
                                            <span>Frequency:</span>
                                            <span x-text="serverHealth.cpu.frequency_mhz + ' MHz'"></span>
                                        </div>
                                        <div x-show="serverHealth.cpu?.process_count">
                                            <span>Processes:</span>
                                            <span x-text="serverHealth.cpu?.process_count?.toLocaleString()"></span>
                                        </div>
                                    </div>
                                    <!-- Memory Details -->
                                    <div class="server-stat-details"
                                        x-show="serverHealth.memory && serverHealth.memory.total_gb">
                                        <div style="font-weight: 600; margin-bottom: 8px; color: var(--text-primary);">
                                            Memory Details</div>
                                        <div>
                                            <span>Used:</span>
                                            <span
                                                x-text="serverHealth.memory.used_gb ? serverHealth.memory.used_gb + ' GB' : 'N/A'"></span>
                                        </div>
                                        <div>
                                            <span>Available:</span>
                                            <span
                                                x-text="serverHealth.memory.available_gb ? serverHealth.memory.available_gb + ' GB' : 'N/A'"></span>
                                        </div>
                                        <div>
                                            <span>Total:</span>
                                            <span
                                                x-text="serverHealth.memory.total_gb ? serverHealth.memory.total_gb + ' GB' : 'N/A'"></span>
                                        </div>
                                        <div x-show="serverHealth.memory.buffers_gb">
                                            <span>Buffers:</span>
                                            <span x-text="serverHealth.memory.buffers_gb + ' GB'"></span>
                                        </div>
                                        <div x-show="serverHealth.memory.cached_gb">
                                            <span>Cached:</span>
                                            <span x-text="serverHealth.memory.cached_gb + ' GB'"></span>
                                        </div>
                                        <div x-show="serverHealth.memory.process_mb">
                                            <span>Process:</span>
                                            <span x-text="serverHealth.memory.process_mb + ' MB'"></span>
                                        </div>
                                        <div x-show="serverHealth.memory.pressure">
                                            <span>Pressure:</span>
                                            <span :class="{
                                                        'text-green': serverHealth.memory.pressure === 'low',
                                                        'text-yellow': serverHealth.memory.pressure === 'medium',
                                                        'text-red': serverHealth.memory.pressure === 'high'
                                                    }"
                                                x-text="serverHealth.memory.pressure ? serverHealth.memory.pressure.toUpperCase() : 'N/A'"></span>
                                        </div>
                                        <div
                                            x-show="serverHealth.memory.swap_total_gb && serverHealth.memory.swap_total_gb > 0 && serverHealth.memory.swap_percent !== undefined">
                                            <span>Swap:</span>
                                            <span x-text="serverHealth.memory.swap_percent + '%'"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 3. Network & NetFlow -->
                <div x-data="{ 
                                        expanded: false,
                                        getPrimaryInterface() {
                                            if (!serverHealth.network || !serverHealth.network.interfaces) return null;
                                            const ifaces = serverHealth.network.interfaces;
                                            // Prefer eth0, then eth1, then first non-loopback interface
                                            let ifaceName = null;
                                            let ifaceData = null;
                                            if (ifaces['eth0']) {
                                                ifaceName = 'eth0';
                                                ifaceData = ifaces['eth0'];
                                            } else if (ifaces['eth1']) {
                                                ifaceName = 'eth1';
                                                ifaceData = ifaces['eth1'];
                                            } else {
                                                const name = Object.keys(ifaces).find(n => n !== 'lo' && !n.startsWith('lo:'));
                                                if (name) {
                                                    ifaceName = name;
                                                    ifaceData = ifaces[name];
                                                }
                                            }
                                            if (!ifaceName || !ifaceData) return null;
                                            return { name: ifaceName, data: ifaceData };
                                        }
                                    }"
                    x-show="(serverHealth.network && serverHealth.network.interfaces && Object.keys(serverHealth.network.interfaces).length > 0) || (serverHealth.netflow && !serverHealth.netflow.error)">
                    {% set network_badge %}
                    <span class="server-stat-badge" :class="{
                                            'badge-success': serverHealth.netflow?.available,
                                            'badge-error': serverHealth.netflow && !serverHealth.netflow.available
                                        }" x-text="serverHealth.netflow?.available ? 'ONLINE' : 'ACTIVE'"></span>
                    {% endset %}
                    <div class="card">
                        <h2>
                            <div class="card-title-content">
                                <span class="title-icon">üåê</span>
                                <span>Network & NetFlow</span>
                            </div>
                            <div class="card-actions">
                                {{ network_badge | safe }}
                            </div>
                        </h2>
                        <div class="widget-body" style="min-height: 300px;">
                            <div x-show="!serverHealth.loading">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                    <!-- Network Summary -->
                                    <template x-if="getPrimaryInterface()">
                                        <div>
                                            <div style="font-size: 0.85em; color: var(--text-secondary); margin-bottom: 4px;"
                                                x-text="'Interface (' + getPrimaryInterface().name + ')'">
                                            </div>
                                            <div class="server-stat-value" style="font-size: 0.9em;">
                                                <div>RX: <span
                                                        x-text="getPrimaryInterface().data.rx_bytes ? fmtBytes(getPrimaryInterface().data.rx_bytes) : 'N/A'"></span>
                                                </div>
                                                <div style="margin-top: 4px;">TX: <span
                                                        x-text="getPrimaryInterface().data.tx_bytes ? fmtBytes(getPrimaryInterface().data.tx_bytes) : 'N/A'"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </template>
                                    <!-- NetFlow Summary -->
                                    <div x-show="serverHealth.netflow && !serverHealth.netflow.error">
                                        <div
                                            style="font-size: 0.85em; color: var(--text-secondary); margin-bottom: 4px;">
                                            NetFlow</div>
                                        <div class="server-stat-value"
                                            x-text="serverHealth.netflow.files_count !== undefined ? serverHealth.netflow.files_count.toLocaleString() + ' files' : 'N/A'">
                                        </div>
                                    </div>
                                </div>
                                <button @click="expanded = !expanded"
                                    style="margin-top: 12px; padding: 6px 12px; background: rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; color: var(--text-secondary); cursor: pointer; font-size: 0.85em;">
                                    <span x-text="expanded ? '‚ñº Hide Details' : '‚ñ∂ Show Details'"></span>
                                </button>
                                <div x-show="expanded" x-collapse
                                    style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255,255,255,0.1);">
                                    <!-- Network Details -->
                                    <template x-if="getPrimaryInterface()">
                                        <div class="server-stat-details">
                                            <div style="font-weight: 600; margin-bottom: 8px; color: var(--text-primary);"
                                                x-text="'Network Interface Details (' + getPrimaryInterface().name + ')'">
                                            </div>
                                            <div>
                                                <span>RX:</span>
                                                <span
                                                    x-text="getPrimaryInterface().data.rx_bytes ? fmtBytes(getPrimaryInterface().data.rx_bytes) : 'N/A'"></span>
                                            </div>
                                            <div>
                                                <span>TX:</span>
                                                <span
                                                    x-text="getPrimaryInterface().data.tx_bytes ? fmtBytes(getPrimaryInterface().data.tx_bytes) : 'N/A'"></span>
                                            </div>
                                            <div>
                                                <span>RX Packets:</span>
                                                <span
                                                    x-text="getPrimaryInterface().data.rx_packets ? getPrimaryInterface().data.rx_packets.toLocaleString() : '0'"></span>
                                            </div>
                                            <div>
                                                <span>TX Packets:</span>
                                                <span
                                                    x-text="getPrimaryInterface().data.tx_packets ? getPrimaryInterface().data.tx_packets.toLocaleString() : '0'"></span>
                                            </div>
                                        </div>
                                    </template>
                                    <!-- NetFlow Details -->
                                    <div class="server-stat-details"
                                        x-show="serverHealth.netflow && !serverHealth.netflow.error">
                                        <div style="font-weight: 600; margin-bottom: 8px; color: var(--text-primary);">
                                            NetFlow Details</div>
                                        <div x-show="serverHealth.netflow.version"
                                            style="display: flex; justify-content: space-between; align-items: flex-start; gap: 8px;">
                                            <span style="flex-shrink: 0;">Version:</span>
                                            <span x-text="serverHealth.netflow.version"
                                                style="font-size: 0.85em; word-break: break-word; white-space: normal; text-align: right; flex: 1;"></span>
                                        </div>
                                        <div x-show="serverHealth.netflow.directory">
                                            <span>Directory:</span>
                                            <span x-text="serverHealth.netflow.directory"
                                                style="font-size: 0.85em;"></span>
                                        </div>
                                        <div x-show="serverHealth.netflow.files_count !== undefined">
                                            <span>Files:</span>
                                            <span x-text="serverHealth.netflow.files_count.toLocaleString()"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 4. Storage & Database -->
                <div x-data="{ expanded: false }"
                    x-show="(serverHealth.disk && serverHealth.disk.root && !serverHealth.disk.error) || databaseStats.databases?.length > 0">
                    {% set storage_badge %}
                    <span class="server-stat-badge" :class="{
                                            'badge-success': (serverHealth.disk?.root?.percent_used || 0) < 80,
                                            'badge-warning': (serverHealth.disk?.root?.percent_used || 0) >= 80 && (serverHealth.disk?.root?.percent_used || 0) < 90,
                                            'badge-error': (serverHealth.disk?.root?.percent_used || 0) >= 90
                                        }"
                        x-text="serverHealth.disk?.root?.percent_used ? serverHealth.disk.root.percent_used + '%' : 'OK'"></span>
                    {% endset %}
                    <div class="card">
                        <h2>
                            <div class="card-title-content">
                                <span class="title-icon">üíøüóÑÔ∏è</span>
                                <span>Storage & Database</span>
                            </div>
                            <div class="card-actions">
                                {{ storage_badge | safe }}
                            </div>
                        </h2>
                        <div class="widget-body" style="min-height: 300px;">
                            <div x-show="!serverHealth.loading">
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                    <!-- Disk Summary -->
                                    <div
                                        x-show="serverHealth.disk && serverHealth.disk.root && !serverHealth.disk.error">
                                        <div
                                            style="font-size: 0.85em; color: var(--text-secondary); margin-bottom: 4px;">
                                            Disk (Root)</div>
                                        <div class="server-stat-value"
                                            x-text="serverHealth.disk.root.percent_used ? serverHealth.disk.root.percent_used + '%' : 'N/A'">
                                        </div>
                                        <div class="server-stat-progress"
                                            x-show="serverHealth.disk.root.percent_used !== undefined">
                                            <div class="server-stat-progress-bar" :class="{
                                                        'warning': serverHealth.disk.root.percent_used >= 80 && serverHealth.disk.root.percent_used < 90,
                                                        'error': serverHealth.disk.root.percent_used >= 90
                                                    }"
                                                :style="'width: ' + (serverHealth.disk.root.percent_used || 0) + '%'">
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Database Summary -->
                                    <div x-show="databaseStats.databases && databaseStats.databases.length > 0">
                                        <div
                                            style="font-size: 0.85em; color: var(--text-secondary); margin-bottom: 4px;">
                                            SQLite Databases</div>
                                        <div class="server-stat-value"
                                            x-text="databaseStats.databases.length + ' databases'">
                                        </div>
                                    </div>
                                </div>
                                <button @click="expanded = !expanded"
                                    style="margin-top: 12px; padding: 6px 12px; background: rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; color: var(--text-secondary); cursor: pointer; font-size: 0.85em;">
                                    <span x-text="expanded ? '‚ñº Hide Details' : '‚ñ∂ Show Details'"></span>
                                </button>
                                <div x-show="expanded" x-collapse
                                    style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255,255,255,0.1);">
                                    <!-- Disk Details -->
                                    <div class="server-stat-details"
                                        x-show="serverHealth.disk && serverHealth.disk.root && !serverHealth.disk.error">
                                        <div style="font-weight: 600; margin-bottom: 8px; color: var(--text-primary);">
                                            Disk Details</div>
                                        <div>
                                            <span>Used:</span>
                                            <span
                                                x-text="serverHealth.disk.root.used_gb ? serverHealth.disk.root.used_gb + ' GB' : 'N/A'"></span>
                                        </div>
                                        <div>
                                            <span>Free:</span>
                                            <span
                                                x-text="serverHealth.disk.root.free_gb ? serverHealth.disk.root.free_gb + ' GB' : 'N/A'"></span>
                                        </div>
                                        <div>
                                            <span>Total:</span>
                                            <span
                                                x-text="serverHealth.disk.root.total_gb ? serverHealth.disk.root.total_gb + ' GB' : 'N/A'"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </template>

        <!-- System Diagnostics (Collapsed by default) -->
        <template x-if="!serverHealth.loading && !serverHealth.error">
            <div x-data="{ expanded: false }" style="margin-top: 32px;">
                <button @click="expanded = !expanded"
                    style="width: 100%; padding: 16px; background: rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: var(--text-primary); cursor: pointer; font-size: 1.1em; font-weight: 600; text-align: left; display: flex; justify-content: space-between; align-items: center;">
                    <span>üîß System Diagnostics</span>
                    <span x-text="expanded ? '‚ñº' : '‚ñ∂'" style="font-size: 0.9em;"></span>
                </button>
                <div x-show="expanded" x-collapse style="margin-top: 16px;">
                    <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                        <!-- Full Syslog Widget -->
                        {% set syslog_badge %}
                        <span class="server-stat-badge" :class="{
                                                'badge-success': serverHealth.syslog.active,
                                                'badge-error': !serverHealth.syslog.active
                                            }" x-text="serverHealth.syslog.active ? 'ACTIVE' : 'INACTIVE'"></span>
                        {% endset %}
                        <div x-show="serverHealth.syslog && !serverHealth.syslog.error">
                            {% call widget_card('server_syslog', 'Filter (514)', 'üìù',
                            extra_actions=syslog_badge) %}
                            <div class="server-stat-value"
                                x-text="serverHealth.syslog.received ? serverHealth.syslog.received.toLocaleString() : '0'">
                            </div>
                            <div class="server-stat-details">
                                <div>
                                    <span>Received:</span>
                                    <span
                                        x-text="serverHealth.syslog.received ? serverHealth.syslog.received.toLocaleString() : '0'"></span>
                                </div>
                                <div>
                                    <span>Parsed:</span>
                                    <span
                                        x-text="serverHealth.syslog.parsed ? serverHealth.syslog.parsed.toLocaleString() : '0'"></span>
                                </div>
                                <div>
                                    <span>Errors:</span>
                                    <span
                                        x-text="serverHealth.syslog.errors ? serverHealth.syslog.errors.toLocaleString() : '0'"
                                        :class="serverHealth.syslog.errors > 0 ? 'text-red' : ''"></span>
                                </div>
                                <div x-show="serverHealth.syslog.last_log">
                                    <span>Last Log:</span>
                                    <span
                                        x-text="serverHealth.syslog.last_log ? new Date(serverHealth.syslog.last_log * 1000).toLocaleTimeString() : 'Never'"></span>
                                </div>
                            </div>
                            {% endcall %}
                        </div>

                        <!-- Firewall Syslog Widget (Port 515) -->
                        {% set firewall_syslog_badge %}
                        <span class="server-stat-badge" :class="{
                                                'badge-success': serverHealth.firewall_syslog && serverHealth.firewall_syslog.active,
                                                'badge-error': serverHealth.firewall_syslog && !serverHealth.firewall_syslog.active
                                            }" x-text="serverHealth.firewall_syslog && serverHealth.firewall_syslog.active ? 'ACTIVE' : 'INACTIVE'"></span>
                        {% endset %}
                        <div x-show="serverHealth.firewall_syslog">
                            {% call widget_card('server_firewall_syslog', 'Firewall logs (515)', 'üì°',
                            extra_actions=firewall_syslog_badge) %}
                            <div class="server-stat-value"
                                x-text="serverHealth.firewall_syslog.received ? serverHealth.firewall_syslog.received.toLocaleString() : '0'">
                            </div>
                            <div class="server-stat-details">
                                <div>
                                    <span>Received:</span>
                                    <span
                                        x-text="serverHealth.firewall_syslog.received ? serverHealth.firewall_syslog.received.toLocaleString() : '0'"></span>
                                </div>
                                <div>
                                    <span>Parsed:</span>
                                    <span
                                        x-text="serverHealth.firewall_syslog.parsed ? serverHealth.firewall_syslog.parsed.toLocaleString() : '0'"></span>
                                </div>
                                <div>
                                    <span>Errors:</span>
                                    <span
                                        x-text="serverHealth.firewall_syslog.errors ? serverHealth.firewall_syslog.errors.toLocaleString() : '0'"
                                        :class="serverHealth.firewall_syslog.errors > 0 ? 'text-red' : ''"></span>
                                </div>
                                <div x-show="serverHealth.firewall_syslog.last_log">
                                    <span>Last Log:</span>
                                    <span
                                        x-text="serverHealth.firewall_syslog.last_log ? new Date(serverHealth.firewall_syslog.last_log * 1000).toLocaleTimeString() : 'Never'"></span>
                                </div>
                            </div>
                            {% endcall %}
                        </div>

                        <!-- Full Database Widget (old one) -->
                        {% set db_badge %}
                        <span class="server-stat-badge" :class="{
                                                'badge-success': serverHealth.database.connected,
                                                'badge-error': !serverHealth.database.connected
                                            }"
                            x-text="serverHealth.database.connected ? 'CONNECTED' : 'DISCONNECTED'"></span>
                        {% endset %}
                        <div x-show="serverHealth.database">
                            {% call widget_card('server_database', 'Database', 'üóÑÔ∏è',
                            extra_actions=db_badge) %}
                            <div class="server-stat-value"
                                x-text="serverHealth.database.log_count ? serverHealth.database.log_count.toLocaleString() : '0'">
                            </div>
                            <div class="server-stat-details">
                                <div>
                                    <span>Logs:</span>
                                    <span
                                        x-text="serverHealth.database.log_count ? serverHealth.database.log_count.toLocaleString() : '0'"></span>
                                </div>
                                <div x-show="serverHealth.database.size_mb">
                                    <span>Size:</span>
                                    <span x-text="serverHealth.database.size_mb + ' MB'"></span>
                                </div>
                                <div x-show="serverHealth.database?.growth_rate_per_hour !== undefined">
                                    <span>Growth (1h):</span>
                                    <span
                                        x-text="(serverHealth.database?.growth_rate_per_hour || 0).toLocaleString() + ' logs'"></span>
                                </div>
                                <div x-show="serverHealth.database?.growth_rate_per_day !== undefined">
                                    <span>Growth (24h):</span>
                                    <span
                                        x-text="(serverHealth.database?.growth_rate_per_day || 0).toLocaleString() + ' logs'"></span>
                                </div>
                                <div x-show="serverHealth.database.path">
                                    <span>Path:</span>
                                    <span x-text="serverHealth.database.path" style="font-size: 0.85em;"></span>
                                </div>
                            </div>
                            {% endcall %}
                        </div>

                        <!-- Full System Information -->
                        {% set system_badge %}
                        <span class="server-stat-badge badge-success">ONLINE</span>
                        {% endset %}
                        <div x-show="serverHealth.system && !serverHealth.system.error">
                            {% call widget_card('server_system', 'System', 'üñ•Ô∏è',
                            extra_actions=system_badge) %}
                            <div class="server-stat-value" x-text="serverHealth.system.hostname || 'N/A'"
                                style="font-size: 1.2em;"></div>
                            <div class="server-stat-details">
                                <div x-show="serverHealth.system.uptime_formatted">
                                    <span>Uptime:</span>
                                    <span x-text="serverHealth.system.uptime_formatted || 'N/A'"></span>
                                </div>
                                <div x-show="serverHealth.system.uptime_seconds">
                                    <span>Total Uptime:</span>
                                    <span
                                        x-text="serverHealth.system.uptime_seconds ? Math.floor(serverHealth.system.uptime_seconds / 86400) + ' days' : 'N/A'"></span>
                                </div>
                                <div x-show="serverHealth.system.boot_time_formatted">
                                    <span>Boot Time:</span>
                                    <span x-text="serverHealth.system.boot_time_formatted"></span>
                                </div>
                                <div x-show="serverHealth.system.kernel_version">
                                    <span>Kernel:</span>
                                    <span x-text="serverHealth.system.kernel_version" style="font-size: 0.85em;"></span>
                                </div>
                                <div x-show="serverHealth.system.os_info">
                                    <span>OS:</span>
                                    <span x-text="serverHealth.system.os_info" style="font-size: 0.85em;"></span>
                                </div>
                                <div x-show="serverHealth.timestamp">
                                    <span>Last Update:</span>
                                    <span
                                        x-text="serverHealth.timestamp ? new Date(serverHealth.timestamp).toLocaleString() : 'N/A'"></span>
                                </div>
                            </div>
                            {% endcall %}
                        </div>

                        <!-- Process Widget -->
                        {% set process_badge %}
                        <span class="server-stat-badge badge-success">ACTIVE</span>
                        {% endset %}
                        <div
                            x-show="(serverHealth.system && serverHealth.system.process_threads !== undefined && !serverHealth.system.error) || serverHealth.process">
                            {% call widget_card('server_process', 'Process', '‚öôÔ∏è',
                            extra_actions=process_badge) %}
                            <div class="server-stat-value"
                                x-text="serverHealth.process && serverHealth.process.process_memory_mb ? serverHealth.process.process_memory_mb + ' MB' : (serverHealth.system && serverHealth.system.process_threads ? serverHealth.system.process_threads.toLocaleString() + ' threads' : 'N/A')">
                            </div>
                            <div class="server-stat-details">
                                <div x-show="serverHealth.process && serverHealth.process.process_memory_mb">
                                    <span>Memory:</span>
                                    <span x-text="serverHealth.process.process_memory_mb + ' MB'"></span>
                                </div>
                                <div x-show="serverHealth.process && serverHealth.process.threads">
                                    <span>Threads:</span>
                                    <span x-text="serverHealth.process.threads.toLocaleString()"></span>
                                </div>
                                <div x-show="serverHealth.system && serverHealth.system.process_threads !== undefined">
                                    <span>System Threads:</span>
                                    <span
                                        x-text="serverHealth.system.process_threads ? serverHealth.system.process_threads.toLocaleString() : '0'"></span>
                                </div>
                                <div x-show="serverHealth.system && serverHealth.system.process_name">
                                    <span>Process:</span>
                                    <span x-text="serverHealth.system.process_name || 'N/A'"
                                        style="font-size: 0.85em;"></span>
                                </div>
                            </div>
                            {% endcall %}
                        </div>

                        <!-- Cache Widget -->
                        {% set cache_badge %}
                        <span class="server-stat-badge badge-success">ACTIVE</span>
                        {% endset %}
                        <div x-show="serverHealth.cache">
                            {% call widget_card('server_cache', 'Cache', 'üíæ',
                            extra_actions=cache_badge) %}
                            <div class="server-stat-value"
                                x-text="(serverHealth.cache.dns_cache_size || 0) + (serverHealth.cache.geo_cache_size || 0) + (serverHealth.cache.common_cache_size || 0) + ' entries'">
                            </div>
                            <div class="server-stat-details">
                                <div x-show="serverHealth.cache.dns_cache_size !== undefined">
                                    <span>DNS Cache:</span>
                                    <span
                                        x-text="serverHealth.cache.dns_cache_size.toLocaleString() + ' entries'"></span>
                                </div>
                                <div x-show="serverHealth.cache.geo_cache_size !== undefined">
                                    <span>GeoIP Cache:</span>
                                    <span
                                        x-text="serverHealth.cache.geo_cache_size.toLocaleString() + ' entries'"></span>
                                </div>
                                <div x-show="serverHealth.cache.common_cache_size !== undefined">
                                    <span>Common Cache:</span>
                                    <span
                                        x-text="serverHealth.cache.common_cache_size.toLocaleString() + ' entries'"></span>
                                </div>
                                <div x-show="serverHealth.cache.bandwidth_history_size !== undefined">
                                    <span>Bandwidth History:</span>
                                    <span
                                        x-text="serverHealth.cache.bandwidth_history_size.toLocaleString() + ' entries'"></span>
                                </div>
                            </div>
                            {% endcall %}
                        </div>
                    </div>
                </div>
            </div>
        </template>

        <!-- System Activity (Compact inline metrics) -->
        <div class="card" style="margin-top: 32px; width: 100%;"
            x-show="!serverHealth.loading && !serverHealth.error && serverHealth">
            <h2>
                <div class="card-title-content">
                    <span class="title-icon">üìä</span>
                    <span>System Activity</span>
                </div>
            </h2>
            <div class="widget-body" style="padding: 16px;">
                <div
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; font-size: 0.9em; min-height: 80px;">
                    <!-- Ingestion Rate -->
                    <div style="display: flex; flex-direction: column; gap: 8px;">
                        <div
                            style="font-weight: 600; color: var(--text-primary); margin-bottom: 4px; display: flex; align-items: center; gap: 6px;">
                            <span>üì•</span>
                            <span>Ingestion Rate</span>
                            <span class="server-stat-badge"
                                style="font-size: 0.75em; padding: 2px 6px; margin-left: auto; color: var(--neon-cyan); border: 1px solid var(--neon-cyan); background: rgba(0,243,255,0.1);">LIVE</span>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 4px; color: var(--text-secondary);">
                            <div style="display: flex; justify-content: space-between;">
                                <span>Filter (514):</span>
                                <span style="color: var(--text-primary); font-weight: 500;"
                                    x-text="ingestionRates && ingestionRates.syslog_eps !== undefined ? ingestionRates.syslog_eps + ' /s' : '‚Äî'"></span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>Firewall events:</span>
                                <span style="color: var(--text-primary); font-weight: 500;"
                                    x-text="ingestionRates && ingestionRates.firewall_eps !== undefined ? ingestionRates.firewall_eps + ' /s' : '‚Äî'"></span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>NetFlow:</span>
                                <span style="color: var(--text-primary); font-weight: 500;"
                                    x-text="ingestionRates && ingestionRates.netflow_eps !== undefined ? ingestionRates.netflow_eps + ' /s' : '‚Äî'"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Syslog Activity -->
                    <div x-show="serverHealth && serverHealth.syslog && !serverHealth.syslog.error"
                        style="display: flex; flex-direction: column; gap: 8px;">
                        <div
                            style="font-weight: 600; color: var(--text-primary); margin-bottom: 4px; display: flex; align-items: center; gap: 6px;">
                            <span>üìù</span>
                            <span>Filter (514)</span>
                            <span class="server-stat-badge" :class="{
                                                    'badge-success': serverHealth.syslog && serverHealth.syslog.active,
                                                    'badge-error': serverHealth.syslog && !serverHealth.syslog.active
                                                }" style="font-size: 0.75em; padding: 2px 6px; margin-left: auto;"
                                x-text="serverHealth.syslog && serverHealth.syslog.active ? 'ACTIVE' : 'INACTIVE'"></span>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 4px; color: var(--text-secondary);">
                            <div style="display: flex; justify-content: space-between;">
                                <span>Received:</span>
                                <span style="color: var(--text-primary); font-weight: 500;"
                                    x-text="serverHealth.syslog && serverHealth.syslog.received ? serverHealth.syslog.received.toLocaleString() : '0'"></span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>Parsed:</span>
                                <span style="color: var(--text-primary); font-weight: 500;"
                                    x-text="serverHealth.syslog && serverHealth.syslog.parsed ? serverHealth.syslog.parsed.toLocaleString() : '0'"></span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>Errors:</span>
                                <span style="color: var(--text-primary); font-weight: 500;"
                                    x-text="serverHealth.syslog && serverHealth.syslog.errors ? serverHealth.syslog.errors.toLocaleString() : '0'"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Firewall Syslog Activity (Port 515) -->
                    <div x-show="serverHealth && serverHealth.firewall_syslog"
                        style="display: flex; flex-direction: column; gap: 8px;">
                        <div
                            style="font-weight: 600; color: var(--text-primary); margin-bottom: 4px; display: flex; align-items: center; gap: 6px;">
                            <span>üì°</span>
                            <span>Firewall logs (515)</span>
                            <span class="server-stat-badge" :class="{
                                                    'badge-success': serverHealth.firewall_syslog && serverHealth.firewall_syslog.active,
                                                    'badge-error': serverHealth.firewall_syslog && !serverHealth.firewall_syslog.active
                                                }" style="font-size: 0.75em; padding: 2px 6px; margin-left: auto;"
                                x-text="serverHealth.firewall_syslog && serverHealth.firewall_syslog.active ? 'ACTIVE' : 'INACTIVE'"></span>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 4px; color: var(--text-secondary);">
                            <div style="display: flex; justify-content: space-between;">
                                <span>Received:</span>
                                <span style="color: var(--text-primary); font-weight: 500;"
                                    x-text="serverHealth.firewall_syslog && serverHealth.firewall_syslog.received ? serverHealth.firewall_syslog.received.toLocaleString() : '0'"></span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>Parsed:</span>
                                <span style="color: var(--text-primary); font-weight: 500;"
                                    x-text="serverHealth.firewall_syslog && serverHealth.firewall_syslog.parsed ? serverHealth.firewall_syslog.parsed.toLocaleString() : '0'"></span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>Errors:</span>
                                <span style="color: var(--text-primary); font-weight: 500;"
                                    x-text="serverHealth.firewall_syslog && serverHealth.firewall_syslog.errors ? serverHealth.firewall_syslog.errors.toLocaleString() : '0'"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Database Activity -->
                    <div x-show="serverHealth && serverHealth.database"
                        style="display: flex; flex-direction: column; gap: 8px;">
                        <div
                            style="font-weight: 600; color: var(--text-primary); margin-bottom: 4px; display: flex; align-items: center; gap: 6px;">
                            <span>üóÑÔ∏è</span>
                            <span>Database</span>
                            <span class="server-stat-badge" :class="{
                                                    'badge-success': serverHealth.database && serverHealth.database.connected,
                                                    'badge-error': serverHealth.database && !serverHealth.database.connected
                                                }" style="font-size: 0.75em; padding: 2px 6px; margin-left: auto;"
                                x-text="serverHealth.database && serverHealth.database.connected ? 'CONNECTED' : 'DISCONNECTED'"></span>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 4px; color: var(--text-secondary);">
                            <div style="display: flex; justify-content: space-between;">
                                <span>Log Count:</span>
                                <span style="color: var(--text-primary); font-weight: 500;"
                                    x-text="serverHealth.database && serverHealth.database.log_count ? serverHealth.database.log_count.toLocaleString() : '0'"></span>
                            </div>
                            <div style="display: flex; justify-content: space-between;"
                                x-show="serverHealth.database && serverHealth.database.growth_rate_per_hour !== undefined">
                                <span>Growth (1h):</span>
                                <span style="color: var(--text-primary); font-weight: 500;"
                                    x-text="(serverHealth.database && serverHealth.database.growth_rate_per_hour || 0).toLocaleString() + ' logs'"></span>
                            </div>
                            <div style="display: flex; justify-content: space-between;"
                                x-show="serverHealth.database && serverHealth.database.growth_rate_per_day !== undefined">
                                <span>Growth (24h):</span>
                                <span style="color: var(--text-primary); font-weight: 500;"
                                    x-text="(serverHealth.database && serverHealth.database.growth_rate_per_day || 0).toLocaleString() + ' logs'"></span>
                            </div>
                        </div>
                    </div>

                    <!-- NetFlow Activity -->
                    <div x-show="serverHealth && serverHealth.netflow && !serverHealth.netflow.error"
                        style="display: flex; flex-direction: column; gap: 8px;">
                        <div
                            style="font-weight: 600; color: var(--text-primary); margin-bottom: 4px; display: flex; align-items: center; gap: 6px;">
                            <span>üåê</span>
                            <span>NetFlow</span>
                            <span class="server-stat-badge" :class="{
                                                    'badge-success': serverHealth.netflow && serverHealth.netflow.available,
                                                    'badge-error': serverHealth.netflow && !serverHealth.netflow.available
                                                }" style="font-size: 0.75em; padding: 2px 6px; margin-left: auto;"
                                x-text="serverHealth.netflow && serverHealth.netflow.available ? 'ONLINE' : 'OFFLINE'"></span>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 4px; color: var(--text-secondary);">
                            <div style="display: flex; justify-content: space-between;">
                                <span>File Count:</span>
                                <span style="color: var(--text-primary); font-weight: 500;"
                                    x-text="serverHealth.netflow && serverHealth.netflow.files_count !== undefined ? serverHealth.netflow.files_count.toLocaleString() : 'N/A'"></span>
                            </div>
                            <div style="display: flex; justify-content: space-between;"
                                x-show="serverHealth.netflow && serverHealth.netflow.directory">
                                <span>Status:</span>
                                <span style="color: var(--text-primary); font-size: 0.85em;"
                                    x-text="serverHealth.netflow && serverHealth.netflow.available ? 'Collecting' : 'Idle'"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Database (SQLite) Statistics - Always visible (moved here from below) -->
        <div style="margin-top: 32px;" x-show="!serverHealth.loading && !serverHealth.error">
            <h2 style="margin-bottom: 20px; font-size: 1.2em; color: var(--text-primary);">Database
                (SQLite)</h2>

            <!-- Loading State -->
            <template x-if="databaseStats.loading">
                <div class="empty-state">
                    <span>Loading database statistics...</span>
                </div>
            </template>

            <!-- Error State -->
            <template x-if="databaseStats.error && !databaseStats.loading">
                <div class="empty-state" style="color: var(--neon-red);">
                    <span x-text="databaseStats.error"></span>
                </div>
            </template>

            <!-- Database Stats Content -->
            <template x-if="!databaseStats.loading && !databaseStats.error && databaseStats.databases">
                <div class="grid"
                    style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 24px;">
                    <template x-for="db in databaseStats.databases" :key="db.name">
                        <div class="card">
                            <h3 style="margin-bottom: 12px; font-size: 1em; color: var(--text-primary);">
                                <span x-text="db.name"></span> Database
                                <template x-if="db.error">
                                    <span style="color: var(--neon-red); font-size: 0.85em; margin-left: 8px;">‚ö†Ô∏è</span>
                                </template>
                            </h3>

                            <!-- Stat Cards -->
                            <div
                                style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 16px;">
                                <!-- File Size -->
                                <div style="padding: 8px; background: rgba(0,0,0,0.2); border-radius: 4px;">
                                    <div style="font-size: 0.75em; color: var(--text-secondary); margin-bottom: 4px;">
                                        File Size</div>
                                    <div style="font-size: 0.95em; color: var(--text-primary); margin-bottom: 4px;"
                                        x-text="db.file_size ? fmtBytes(db.file_size) : 'N/A'">
                                    </div>
                                    <template x-if="db.size_history && db.size_history.length > 1">
                                        <canvas x-bind:id="'dbSparkline_' + db.name"
                                            style="width: 100%; height: 24px; display: block;" width="120"
                                            height="24"></canvas>
                                    </template>
                                </div>

                                <!-- Total Records -->
                                <div style="padding: 8px; background: rgba(0,0,0,0.2); border-radius: 4px;">
                                    <div style="font-size: 0.75em; color: var(--text-secondary); margin-bottom: 4px;">
                                        Records</div>
                                    <div style="font-size: 0.95em; color: var(--text-primary);"
                                        x-text="db.total_records ? db.total_records.toLocaleString() : 'N/A'">
                                    </div>
                                </div>

                                <!-- WAL Status -->
                                <div style="padding: 8px; background: rgba(0,0,0,0.2); border-radius: 4px;">
                                    <div style="font-size: 0.75em; color: var(--text-secondary); margin-bottom: 4px;">
                                        WAL</div>
                                    <div style="font-size: 0.95em; color: var(--text-primary);">
                                        <template x-if="db.wal_exists">
                                            <span x-text="fmtBytes(db.wal_size)"></span>
                                        </template>
                                        <template
                                            x-if="!db.wal_exists && db.journal_mode && db.journal_mode.toLowerCase() === 'wal'">
                                            <span style="color: var(--text-secondary); opacity: 0.8;"
                                                title="WAL mode enabled but no active WAL file (no pending transactions)">WAL
                                                mode (idle)</span>
                                        </template>
                                        <template
                                            x-if="!db.wal_exists && (!db.journal_mode || db.journal_mode.toLowerCase() !== 'wal')">
                                            <span style="color: var(--text-secondary); opacity: 0.7;"
                                                title="WAL mode not enabled">Not enabled</span>
                                        </template>
                                    </div>
                                </div>

                                <!-- Last Write -->
                                <div style="padding: 8px; background: rgba(0,0,0,0.2); border-radius: 4px;">
                                    <div style="font-size: 0.75em; color: var(--text-secondary); margin-bottom: 4px;">
                                        Last Write</div>
                                    <div style="font-size: 0.85em; color: var(--text-primary);"
                                        x-text="db.last_write ? new Date(db.last_write).toLocaleString() : 'N/A'">
                                    </div>
                                </div>
                            </div>

                            <!-- Write Pressure Hint -->
                            <template x-if="db.write_pressure">
                                <div
                                    style="margin-bottom: 12px; padding: 8px; background: rgba(0,0,0,0.1); border-radius: 4px; border-left: 2px solid rgba(255,255,255,0.2);">
                                    <div style="font-size: 0.8em; color: var(--text-secondary);">
                                        <span style="opacity: 0.8;">Write Activity:</span>
                                        <span style="margin-left: 6px; color: var(--text-primary);"
                                            :class="db.write_pressure === 'elevated' ? 'text-warn' : ''"
                                            x-text="db.write_pressure === 'elevated' ? 'Elevated' : 'Normal'"></span>
                                    </div>
                                </div>
                            </template>

                            <!-- Retention Awareness -->
                            <template x-if="db.oldest_record_age">
                                <div
                                    style="margin-bottom: 12px; padding: 8px; background: rgba(0,0,0,0.1); border-radius: 4px; border-left: 2px solid rgba(255,255,255,0.2);">
                                    <div style="font-size: 0.8em; color: var(--text-secondary);">
                                        <span style="opacity: 0.8;">Oldest Record:</span>
                                        <span style="margin-left: 6px; color: var(--text-primary);"
                                            x-text="db.oldest_record_age"></span>
                                    </div>
                                </div>
                            </template>

                            <!-- Detail Panel -->
                            <div
                                style="padding: 12px; background: rgba(0,0,0,0.15); border-radius: 4px; border-top: 1px solid rgba(255,255,255,0.1);">
                                <div style="font-size: 0.85em; color: var(--text-secondary); margin-bottom: 8px;">
                                    Configuration</div>
                                <div
                                    style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; font-size: 0.85em;">
                                    <div>
                                        <span style="color: var(--text-secondary);">SQLite:</span>
                                        <span style="color: var(--text-primary); margin-left: 6px;"
                                            x-text="db.sqlite_version || 'N/A'"></span>
                                    </div>
                                    <div>
                                        <span style="color: var(--text-secondary);">Journal:</span>
                                        <span style="color: var(--text-primary); margin-left: 6px;"
                                            x-text="db.journal_mode || 'N/A'"></span>
                                    </div>
                                    <div>
                                        <span style="color: var(--text-secondary);">Sync:</span>
                                        <span style="color: var(--text-primary); margin-left: 6px;"
                                            x-text="db.synchronous || 'N/A'"></span>
                                    </div>
                                    <div>
                                        <span style="color: var(--text-secondary);">Page
                                            Size:</span>
                                        <span style="color: var(--text-primary); margin-left: 6px;"
                                            x-text="db.page_size ? fmtBytes(db.page_size) : 'N/A'"></span>
                                    </div>
                                    <div>
                                        <span style="color: var(--text-secondary);">Cache:</span>
                                        <span style="color: var(--text-primary); margin-left: 6px;">
                                            <template x-if="db.cache_size && db.page_size">
                                                <span x-text="db.cache_size + ' pages'"></span>
                                                <span
                                                    style="color: var(--text-secondary); opacity: 0.7; margin-left: 4px;"
                                                    x-text="'(' + fmtBytes(db.cache_size * db.page_size) + ')'"></span>
                                            </template>
                                            <template x-if="db.cache_size && !db.page_size">
                                                <span x-text="db.cache_size + ' pages'"></span>
                                            </template>
                                            <template x-if="!db.cache_size">
                                                <span>N/A</span>
                                            </template>
                                        </span>
                                    </div>
                                    <div>
                                        <span style="color: var(--text-secondary);">Foreign
                                            Keys:</span>
                                        <span style="color: var(--text-primary); margin-left: 6px;"
                                            :title="db.foreign_keys ? 'Enabled: Enforces referential integrity but may impact write performance' : (db.foreign_keys === false ? 'Disabled: Better write performance but no referential integrity checks' : '')"
                                            x-text="db.foreign_keys !== null ? (db.foreign_keys ? 'Enabled' : 'Disabled') : 'N/A'"></span>
                                    </div>
                                </div>
                                <template x-if="db.path">
                                    <div
                                        style="margin-top: 8px; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.05);">
                                        <div style="font-size: 0.75em; color: var(--text-secondary);">
                                            Path:</div>
                                        <div style="font-size: 0.8em; color: var(--text-primary); font-family: monospace; word-break: break-all;"
                                            x-text="db.path"></div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </template>
                </div>
            </template>
        </div>

        <!-- Server Logs Widget - At bottom of Server tab -->
        <div class="card" style="margin-top: 32px;">
            <h2>
                <div class="card-title-content">
                    <span class="title-icon">üìã</span>
                    <span>Server Logs</span>
                </div>
                <div class="card-actions">
                    <span class="server-stat-badge" :class="{
                                            'badge-success': serverLogs.source === 'buffer' || serverLogs.source === 'docker',
                                            'badge-warning': serverLogs.source === 'files',
                                            'badge-error': serverLogs.source === 'none'
                                        }"
                        x-text="serverLogs.source === 'docker' ? 'DOCKER' : (serverLogs.source === 'buffer' ? 'BUFFER' : (serverLogs.source === 'files' ? 'FILES' : 'N/A'))"></span>
                </div>
            </h2>
            <div class="widget-body"
                style="min-height: 400px; max-height: 600px; display: flex; flex-direction: column;">
                <div
                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <div style="display: flex; gap: 8px; align-items: center;">
                        <span style="font-size: 0.85em; color: var(--text-secondary);">Lines:</span>
                        <select x-model="serverLogs.lines" @change="fetchServerLogs(serverLogs.lines)"
                            aria-label="Number of log lines to display" title="Number of log lines"
                            style="padding: 4px 8px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; color: var(--text-primary); font-size: 0.85em;">
                            <option value="50">50</option>
                            <option value="100">100</option>
                            <option value="200">200</option>
                            <option value="500">500</option>
                        </select>
                        <button @click="fetchServerLogs(serverLogs.lines)" aria-label="Refresh server logs"
                            title="Refresh logs"
                            style="padding: 4px 12px; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 4px; color: var(--text-primary); cursor: pointer; font-size: 0.85em;"
                            :disabled="serverLogs.loading">
                            <span x-text="serverLogs.loading ? 'Loading...' : 'Refresh'"></span>
                        </button>
                    </div>
                    <span style="font-size: 0.85em; color: var(--text-secondary);"
                        x-text="serverLogs.count + ' lines'"></span>
                </div>
                <div x-show="serverLogs.loading"
                    style="text-align: center; padding: 40px; color: var(--text-secondary);">
                    <span>Loading logs...</span>
                </div>
                <div x-show="!serverLogs.loading && serverLogs.logs.length > 0"
                    style="flex: 1; overflow-y: auto; background: rgba(0,0,0,0.2); border-radius: 4px; padding: 12px; font-family: 'Courier New', monospace; font-size: 0.85em; line-height: 1.6;">
                    <template x-for="(log, index) in serverLogs.logs" :key="index">
                        <div style="margin-bottom: 2px; color: var(--text-secondary); word-break: break-all;"
                            x-text="log"></div>
                    </template>
                </div>
                <div x-show="!serverLogs.loading && serverLogs.logs.length === 0"
                    style="text-align: center; padding: 40px; color: var(--text-secondary);">
                    <span>No logs available</span>
                </div>
                <div x-show="serverLogs.container"
                    style="margin-top: 8px; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.1); font-size: 0.8em; color: var(--text-secondary);">
                    <span>Container: </span><span x-text="serverLogs.container"></span>
                </div>
            </div>
        </div>
    </section>
</div>

<!-- ============================================
             FIREWALL SNMP STATUS TAB
             ============================================ -->