<div x-show="activeTab === 'traffic-explorer'" :style="activeTab === 'traffic-explorer' ? 'display:block' : 'display:none'"
    id="traffic-explorer-tab" role="tabpanel" aria-labelledby="traffic-explorer-tab-btn" tabindex="0" class="flow-search">
    <section id="section-traffic-explorer" class="scroll-section mb-6">
        <div class="card" style="margin-bottom: var(--space-4);">
            <h2>
                <div class="card-title-content" style="display: flex; align-items: center; flex: 1; min-width: 0;">
                    <span style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Flow Search</span>
                </div>
            </h2>
            <div class="widget-body">
                <div style="margin-bottom: var(--space-3); color: var(--text-secondary); font-size: var(--text-sm);">
                    Filter and inspect flows (like a searchable tail), then drill into details.
                </div>
                <div
                    style="display: flex; flex-wrap: wrap; gap: var(--space-3); align-items: flex-end; justify-content: flex-start;">
                    <div style="min-width: 220px; flex: 1;">
                        <label class="text-9 text-muted" style="display:block; margin-bottom: 6px;">Entity (IP / hostname)</label>
                        <input type="text" class="cyber-input" style="width: 100%;" placeholder="IP or hostname"
                            x-model="trafficExplorer.filters.search" @input.debounce.300ms="applyTrafficExplorerFilters()">
                    </div>
                    <div style="min-width: 170px;">
                        <label class="text-9 text-muted" style="display:block; margin-bottom: 6px;">Direction</label>
                        <select x-model="trafficExplorer.filters.direction" class="header-select" style="width: 170px;"
                            @change="applyTrafficExplorerFilters()">
                            <option value="all">Any</option>
                            <option value="outbound">LAN ‚Üí WAN</option>
                            <option value="inbound">WAN ‚Üí LAN</option>
                            <option value="internal">LAN ‚Üî LAN</option>
                        </select>
                    </div>
                    <div style="min-width: 120px;">
                        <label class="text-9 text-muted" style="display:block; margin-bottom: 6px;">Signal</label>
                        <select x-model="trafficExplorer.filters.signal" class="header-select" style="width: 120px;"
                            @change="applyTrafficExplorerFilters()">
                            <option value="all">All</option>
                            <option value="unusual">Unusual</option>
                            <option value="notable">Notable</option>
                            <option value="normal">Normal</option>
                        </select>
                    </div>
                    <div style="min-width: 140px;">
                        <label class="text-9 text-muted" style="display:block; margin-bottom: 6px;">Protocol</label>
                        <select x-model="trafficExplorer.filters.protocol" class="header-select" style="width: 140px;"
                            @change="applyTrafficExplorerFilters()">
                            <option value="all">All Protocols</option>
                            <template x-for="proto in trafficExplorer.protocolOptions" :key="proto">
                                <option :value="proto" x-text="proto"></option>
                            </template>
                        </select>
                    </div>
                    <div style="min-width: 110px;">
                        <label class="text-9 text-muted" style="display:block; margin-bottom: 6px;">Min Bytes</label>
                        <input type="number" class="cyber-input" style="width: 100%;" placeholder="0"
                            x-model="trafficExplorer.filters.minBytes" @input.debounce.300ms="applyTrafficExplorerFilters()">
                    </div>
                    <div style="min-width: 100px;">
                        <label class="text-9 text-muted" style="display:block; margin-bottom: 6px;">Min Dur (s)</label>
                        <input type="number" step="0.1" class="cyber-input" style="width: 100%;" placeholder="0"
                            x-model="trafficExplorer.filters.minDuration" @input.debounce.300ms="applyTrafficExplorerFilters()">
                    </div>
                    <div style="display: flex; gap: var(--space-2); align-items: center;">
                        <button class="btn btn--primary btn--sm" @click="fetchTrafficExplorerFlows()">Load Traffic</button>
                        <button class="btn btn--ghost btn--sm" @click="resetTrafficExplorerFilters()">Reset</button>
                    </div>
                    <div style="margin-left: auto; font-size: var(--text-xs); color: var(--text-tertiary);">
                        Updated: <span x-text="getTrafficExplorerGeneratedAt()"></span>
                    </div>
                </div>

                <!-- NEW: Save View Controls -->
                <div style="display: flex; gap: var(--space-2); align-items: center; margin-top: var(--space-2); flex-wrap: wrap; font-size: var(--text-xs);">
                    <select @change="loadView($event.target.value); $event.target.value=''" class="header-select" style="width: 180px;">
                        <option value="">Load View...</option>
                        <optgroup label="Built-in">
                            <template x-for="view in getBuiltInViews()" :key="view.id">
                                <option :value="view.id" x-text="view.name"></option>
                            </template>
                        </optgroup>
                        <optgroup label="Saved" x-show="trafficExplorer.savedViews.length > 0">
                            <template x-for="view in trafficExplorer.savedViews" :key="view.id">
                                <option :value="view.id" x-text="view.name"></option>
                            </template>
                        </optgroup>
                    </select>
                    <button class="btn btn--ghost btn--sm" @click="saveView(prompt('Enter view name:'))">Save View</button>
                    <label style="display: flex; align-items: center; gap: 6px;">
                        <input type="checkbox" x-model="trafficExplorer.contextMarkersEnabled" style="cursor: pointer;">
                        <span>Context markers</span>
                    </label>
                </div>
            </div>
        </div>

        <div class="grid" style="grid-template-columns: minmax(0, 7fr) minmax(0, 3fr); gap: var(--space-4);">
            {% call widget_card('trafficExplorer', 'Flow Matches', 'üßæ', show_spinner=True) %}
            <div class="flow-scrub" @mousedown="trafficExplorerScrubStart($event)" @mousemove.window="trafficExplorerScrubMove($event)"
                @mouseup.window="trafficExplorerScrubEnd()">
                <div class="flow-scrub__bins">
                    <template x-for="(bin, idx) in trafficExplorer.scrub.bins" :key="idx">
                        <span class="flow-scrub__bin" :style="'height:' + (4 + Math.min(bin, 12)) + 'px'"></span>
                    </template>
                </div>
                <div class="flow-scrub__selection" :style="getTrafficExplorerScrubSelectionStyle()"></div>
                <button class="flow-scrub__reset" x-show="trafficExplorer.scrub.active" @click.stop="clearTrafficExplorerScrub()">Reset</button>
            </div>

            <!-- NEW: Context Strip -->
            <template x-if="trafficExplorer.contextSummary">
                <div class="flow-context-strip" style="background: rgba(0, 234, 255, 0.05); border: 1px solid rgba(0, 234, 255, 0.15); border-radius: 4px; padding: 8px 12px; margin-bottom: var(--space-2); font-size: var(--text-xs); line-height: 1.4;">
                    <div style="display: flex; flex-wrap: wrap; gap: 8px 16px; color: var(--text-secondary);">
                        <span><strong x-text="trafficExplorer.contextSummary.showing"></strong> of <span x-text="trafficExplorer.contextSummary.total"></span> ‚Ä¢ Window: <span x-text="trafficExplorer.range"></span></span>
                        <span x-show="trafficExplorer.contextSummary.topTalker">Top talker: <strong class="text-cyan" x-text="trafficExplorer.contextSummary.topTalker"></strong></span>
                        <span x-show="trafficExplorer.contextSummary.topService">Top port: <strong x-text="trafficExplorer.contextSummary.topService"></strong></span>
                        <span x-show="trafficExplorer.contextSummary.topExternal">Top ext: <strong class="text-purple" x-text="trafficExplorer.contextSummary.topExternal"></strong></span>
                        <span x-show="trafficExplorer.contextSummary.dominantReason">Dominant: <strong class="text-yellow" x-text="trafficExplorer.contextSummary.dominantReason"></strong></span>
                        <span x-show="trafficExplorer.contextSummary.firstSeenToday">First seen today: <strong x-text="trafficExplorer.contextSummary.firstSeenToday"></strong></span>
                    </div>
                </div>
            </template>

            <div
                style="display: flex; align-items: center; justify-content: space-between; margin-bottom: var(--space-2); font-size: var(--text-xs); flex-wrap: wrap; gap: var(--space-2);">
                <div style="color: var(--text-tertiary);"
                    x-text="'Showing ' + (trafficExplorer.filtered.length || 0) + ' matches ‚Ä¢ Updated ' + getTrafficExplorerUpdatedAgo()">
                </div>
                <div style="display: flex; align-items: center; gap: var(--space-2);">
                    <select class="header-select" style="width: 120px; font-size: var(--text-xs);"
                        @change="trafficExplorer.sortBy.field = $event.target.value; applyTrafficExplorerFilters()">
                        <option value="signal">Sort: Signal</option>
                        <option value="bytes">Sort: Bytes</option>
                        <option value="packets">Sort: Packets</option>
                        <option value="duration">Sort: Duration</option>
                        <option value="time">Sort: Time</option>
                    </select>
                    <button class="btn btn--ghost btn--sm" @click="exportFlowsCSV()" title="Export filtered flows to CSV">Export CSV</button>
                    <button class="btn btn--ghost btn--sm" @click="trafficExplorerPrevPage()"
                        :disabled="trafficExplorer.page <= 1">Prev</button>
                    <span x-text="'Page ' + trafficExplorer.page + ' / ' + trafficExplorerPageCount"></span>
                    <button class="btn btn--ghost btn--sm" @click="trafficExplorerNextPage()"
                        :disabled="trafficExplorer.page >= trafficExplorerPageCount">Next</button>
                </div>
            </div>
            <div style="overflow: auto; max-height: 560px;" class="font-mono">
                <table class="table-fixed table-compact" style="font-size: 0.74em; line-height: 1.2;">
                    <thead>
                        <tr>
                            <th class="flow-header-cell" style="width: 11%;">Time</th>
                            <th class="flow-header-cell" style="width: 9%;">Signal</th>
                            <th class="flow-header-cell" style="width: 26%;">Src ‚Üí Dst</th>
                            <th class="flow-header-cell" style="width: 8%;">Proto</th>
                            <th class="flow-header-cell" style="width: 7%;">Port</th>
                            <th class="flow-header-cell" style="width: 11%;">Bytes</th>
                            <th class="flow-header-cell" style="width: 10%;">Packets</th>
                            <th class="flow-header-cell" style="width: 10%;">Direction</th>
                            <th class="flow-header-cell" style="width: 8%;">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <template x-if="trafficExplorer.loading && trafficExplorer.flows.length === 0">
                            <template x-for="idx in 8" :key="idx">
                                <tr>
                                    <td class="text-xs text-muted" style="padding: 3px 6px;"
                                        x-text="idx === 1 ? 'Loading traffic‚Ä¶' : '‚Äî'"></td>
                                    <td class="text-xs text-muted" style="padding: 3px 6px;">‚Äî</td>
                                    <td class="text-xs text-muted" style="padding: 3px 6px;">‚Äî</td>
                                    <td class="text-xs text-muted" style="padding: 3px 6px;">‚Äî</td>
                                    <td class="text-xs text-muted" style="padding: 3px 6px;">‚Äî</td>
                                    <td class="text-xs text-muted" style="padding: 3px 6px;">‚Äî</td>
                                    <td class="text-xs text-muted" style="padding: 3px 6px;">‚Äî</td>
                                    <td class="text-xs text-muted" style="padding: 3px 6px;">‚Äî</td>
                                    <td class="text-xs text-muted" style="padding: 3px 6px;">‚Äî</td>
                                </tr>
                            </template>
                        </template>
                        <template x-for="(flow, idx) in trafficExplorerPageFlows" :key="idx">
                            <tr @click="selectTrafficExplorerFlow(flow)" class="flow-row" tabindex="0"
                                :class="{ 'is-pinned': isTrafficExplorerPinned(flow) }"
                                :style="trafficExplorer.selectedFlow === flow ? 'background: rgba(0, 234, 255, 0.08);' : ''">
                                <td class="text-xs text-muted flow-time" style="padding: 2px 6px;"
                                    x-text="getTrafficExplorerFirstSeen(flow)">
                                </td>
                                <td class="text-xs text-muted" style="padding: 2px 6px;">
                                    <div style="display: flex; flex-direction: column; gap: 4px;">
                                        <div style="display: flex; align-items: center; gap: 6px;">
                                            <span :style="'width:6px; height:6px; border-radius:999px; background:' + getTrafficExplorerSignal(flow).color + '; display:inline-block;'"></span>
                                            <span x-text="getTrafficExplorerSignal(flow).label"
                                                :title="getTrafficExplorerSignal(flow).label === 'Normal' ? 'Normal flow' : 'Marked notable due to: ' + (getTrafficExplorerSignalReasons(flow).join(', ') || 'activity flags')"></span>
                                            <span class="flow-pin-indicator" x-show="isTrafficExplorerPinned(flow)">üìå</span>
                                        </div>
                                        <!-- NEW: Reason chips (max 3, clickable) -->
                                        <div style="display: flex; flex-wrap: wrap; gap: 3px;" x-show="getFlowReasonChips(flow).length > 0">
                                            <template x-for="chip in getFlowReasonChips(flow)" :key="chip.value">
                                                <button class="flow-reason-chip" @click.stop="pivotToFilter(chip.field, chip.value)"
                                                    :title="'Click to filter by: ' + chip.label" x-text="chip.label"></button>
                                            </template>
                                        </div>
                                    </div>
                                </td>
                                <td style="padding: 2px 6px;">
                                    <div class="flow-entity">
                                        <div class="flow-entity-main">
                                            <span :class="flow.src ? 'text-cyan flow-ip' : 'text-muted flow-ip'"
                                                x-text="flow.src || 'Not observed'"></span>
                                            <span class="text-muted flow-arrow">‚Üí</span>
                                            <span :class="flow.dst ? 'text-purple flow-ip' : 'text-muted flow-ip'"
                                                x-text="flow.dst || 'Not observed'"></span>
                                        </div>
                                        <div class="flow-entity-sub" x-show="flow.src_hostname || flow.dst_hostname">
                                            <span class="truncate" :title="(flow.src_hostname || 'Unresolved') + ' ‚Üí ' + (flow.dst_hostname || 'Unresolved')"
                                                x-text="(flow.src_hostname || 'Unresolved') + ' ‚Üí ' + (flow.dst_hostname || 'Unresolved')"></span>
                                        </div>
                                        <div class="flow-entity-sub text-muted" x-text="getTrafficExplorerSeenLabel(flow)"></div>
                                        <div class="flow-entity-tags" x-show="getTrafficExplorerTags(flow).length > 0">
                                            <template x-for="tag in getTrafficExplorerTags(flow).slice(0, 2)" :key="tag">
                                                <span class="flow-tag" x-text="tag"></span>
                                            </template>
                                            <span class="flow-tag-more"
                                                x-show="getTrafficExplorerTags(flow).length > 2"
                                                x-text="'+' + (getTrafficExplorerTags(flow).length - 2)"></span>
                                        </div>
                                        <div class="flow-row-actions">
                                            <button class="flow-action-btn" title="Pin flow" aria-label="Pin flow"
                                                @click.stop="toggleTrafficExplorerPin(flow)">üìå</button>
                                            <button class="flow-action-btn" title="Focus on entity" aria-label="Focus on entity"
                                                @click.stop="focusTrafficExplorerEntity(flow)">üîç</button>
                                        </div>
                                    </div>
                                </td>
                                <td class="text-xs text-muted" style="padding: 2px 6px;"
                                    x-text="(flow.proto_name || flow.proto || 'Not classified')">
                                </td>
                                <td class="text-xs text-muted" style="padding: 2px 6px;"
                                    x-text="getTrafficExplorerPort(flow)"></td>
                                <td class="text-xs" style="padding: 2px 6px;"
                                    :class="getTrafficExplorerBytes(flow) === 'Not observed' ? 'text-muted' : ''"
                                    x-text="getTrafficExplorerBytes(flow)">
                                    <span class="flow-marker" x-show="trafficExplorer.contextMarkersEnabled"
                                        :title="getTrafficExplorerContextMarker(flow.bytes, trafficExplorer.medians.bytes).title"
                                        x-text="getTrafficExplorerContextMarker(flow.bytes, trafficExplorer.medians.bytes).symbol"></span>
                                </td>
                                <td class="text-xs" style="padding: 2px 6px;"
                                    :class="flow.packets === undefined ? 'text-muted' : ''"
                                    x-text="flow.packets !== undefined ? flow.packets.toLocaleString() : 'Not observed'"></td>
                                <td class="text-xs text-muted" style="padding: 2px 6px;">
                                    <span class="flow-dir" :title="getTrafficExplorerDirectionCompact(flow).title">
                                        <span x-text="getTrafficExplorerDirectionCompact(flow).symbol"></span>
                                        <span x-text="getTrafficExplorerDirectionCompact(flow).label"></span>
                                    </span>
                                    <span class="flow-marker" x-show="trafficExplorer.contextMarkersEnabled"
                                        :title="getTrafficExplorerContextMarker(getTrafficExplorerDurationSeconds(flow), trafficExplorer.medians.duration).title"
                                        x-text="getTrafficExplorerContextMarker(getTrafficExplorerDurationSeconds(flow), trafficExplorer.medians.duration).symbol"></span>
                                </td>
                                <td class="text-xs text-muted" style="padding: 2px 6px;"
                                    x-text="getTrafficExplorerAction(flow)"></td>
                            </tr>
                        </template>
                    </tbody>
                </table>
                <div x-show="!trafficExplorer.loading && trafficExplorer.filtered.length === 0" class="empty-state"
                    style="margin-top: var(--space-3);">No traffic matching current filters</div>
            </div>
            {% endcall %}

            {% call widget_card('trafficExplorer', 'Flow Details', 'üìå', show_spinner=False) %}
            <template x-if="trafficExplorer.selectedFlow">
                <div>
                    <!-- NEW: Action Buttons -->
                    <div style="display: flex; gap: var(--space-2); margin-bottom: var(--space-3);">
                        <button class="btn btn--ghost btn--sm" @click="copyFlowEvidence(trafficExplorer.selectedFlow)">üìã Copy Evidence</button>
                        <button class="btn btn--ghost btn--sm" @click="exportFlowsCSV()">üíæ Export CSV</button>
                    </div>

                    <!-- NEW: Why This Flow Is Shown -->
                    <div style="background: rgba(0, 234, 255, 0.05); border-left: 3px solid var(--neon-cyan); padding: 8px 10px; margin-bottom: var(--space-3); font-size: var(--text-xs);">
                        <div class="text-muted" style="font-weight: 600; margin-bottom: 4px;">Why Shown</div>
                        <div style="display: flex; flex-wrap: wrap; gap: 4px;">
                            <template x-for="filter in getFlowMatchedFilters(trafficExplorer.selectedFlow)" :key="filter">
                                <span class="badge" style="background: rgba(0, 234, 255, 0.1); font-size: 10px;" x-text="filter"></span>
                            </template>
                        </div>
                    </div>

                    <!-- NEW: Why Unusual/Notable -->
                    <div style="background: rgba(255, 200, 0, 0.05); border-left: 3px solid var(--signal-warn); padding: 8px 10px; margin-bottom: var(--space-3); font-size: var(--text-xs);"
                        x-show="getTrafficExplorerSignal(trafficExplorer.selectedFlow).label !== 'Normal'">
                        <div class="text-muted" style="font-weight: 600; margin-bottom: 4px;">Why Unusual/Notable</div>
                        <ul style="margin: 0; padding-left: 16px;">
                            <template x-for="reason in getFlowUnusualReasons(trafficExplorer.selectedFlow)" :key="reason">
                                <li x-text="reason"></li>
                            </template>
                        </ul>
                    </div>

                    <div class="font-mono" style="font-size: 0.78em; line-height: 1.35;">
                        <div style="display: grid; grid-template-columns: 90px 1fr; gap: 6px 10px; margin-bottom: var(--space-3);">
                        <div class="text-muted">5-tuple</div>
                        <div>
                            <span :class="trafficExplorer.selectedFlow.src ? 'text-cyan' : 'text-muted'"
                                x-text="trafficExplorer.selectedFlow.src || 'Not observed'"></span>
                            <span class="text-muted">:</span>
                            <span :class="trafficExplorer.selectedFlow.src_port ? '' : 'text-muted'"
                                x-text="trafficExplorer.selectedFlow.src_port || 'Not observed'"></span>
                            <span class="text-muted"> ‚Üí </span>
                            <span :class="trafficExplorer.selectedFlow.dst ? 'text-purple' : 'text-muted'"
                                x-text="trafficExplorer.selectedFlow.dst || 'Not observed'"></span>
                            <span class="text-muted">:</span>
                            <span :class="trafficExplorer.selectedFlow.dst_port ? '' : 'text-muted'"
                                x-text="trafficExplorer.selectedFlow.dst_port || 'Not observed'"></span>
                            <span class="text-muted"> (</span>
                            <span
                                :class="(trafficExplorer.selectedFlow.proto_name || trafficExplorer.selectedFlow.proto) ? '' : 'text-muted'"
                                x-text="trafficExplorer.selectedFlow.proto_name || trafficExplorer.selectedFlow.proto || 'Not classified'"></span>
                            <span class="text-muted">)</span>
                        </div>
                        <div class="text-muted">Signal</div>
                        <div style="display: flex; align-items: center; gap: 6px;">
                            <span :style="'width:6px; height:6px; border-radius:999px; background:' + getTrafficExplorerSignal(trafficExplorer.selectedFlow).color + '; display:inline-block;'"></span>
                            <span x-text="getTrafficExplorerSignal(trafficExplorer.selectedFlow).label"></span>
                        </div>
                        <div class="text-muted">Direction</div>
                        <div x-text="getTrafficExplorerDirection(trafficExplorer.selectedFlow).toUpperCase()"></div>
                        <div class="text-muted">Action</div>
                        <div x-text="getTrafficExplorerAction(trafficExplorer.selectedFlow)"></div>
                        <div class="text-muted">Bytes</div>
                        <div :class="getTrafficExplorerBytes(trafficExplorer.selectedFlow) === 'Not observed' ? 'text-muted' : ''"
                            x-text="getTrafficExplorerBytes(trafficExplorer.selectedFlow)"></div>
                        <div class="text-muted">Packets</div>
                        <div :class="trafficExplorer.selectedFlow.packets === undefined ? 'text-muted' : ''"
                            x-text="trafficExplorer.selectedFlow.packets !== undefined ? trafficExplorer.selectedFlow.packets.toLocaleString() : 'Not observed'"></div>
                        <div class="text-muted">Duration</div>
                        <div :class="trafficExplorer.selectedFlow.duration || trafficExplorer.selectedFlow.duration_seconds !== undefined ? '' : 'text-muted'"
                            x-text="trafficExplorer.selectedFlow.duration || (trafficExplorer.selectedFlow.duration_seconds !== undefined ? trafficExplorer.selectedFlow.duration_seconds + 's' : 'Not observed')"></div>
                        <div class="text-muted">First Seen</div>
                        <div x-text="getTrafficExplorerFirstSeen(trafficExplorer.selectedFlow)"></div>
                        <div class="text-muted">Seen Before</div>
                        <div x-text="getTrafficExplorerSeenBefore(trafficExplorer.selectedFlow)"></div>
                        <div class="text-muted">Last Seen</div>
                        <div x-text="getTrafficExplorerLastSeen(trafficExplorer.selectedFlow)"></div>
                        </div>

                        <div style="border-top: 1px solid var(--border-soft); padding-top: var(--space-3); margin-top: var(--space-2);">
                            <div class="text-muted" style="margin-bottom: 6px;">Endpoints</div>
                            <div style="display: grid; grid-template-columns: 1fr; gap: 10px;">
                                <div>
                                    <div class="text-muted" style="font-size: 0.9em;">Source</div>
                                    <div style="display: grid; grid-template-columns: 90px 1fr; gap: 4px 10px;">
                                        <div class="text-muted">DNS</div>
                                        <div class="text-muted" x-text="trafficExplorer.selectedFlow.src_hostname || getTrafficExplorerMeta(trafficExplorer.selectedFlow.src).hostname || 'Unresolved'"></div>
                                        <div class="text-muted">Geo</div>
                                        <div class="text-muted" x-text="trafficExplorer.selectedFlow.src_country || getTrafficExplorerMeta(trafficExplorer.selectedFlow.src).country || 'Not classified'"></div>
                                        <div class="text-muted">ASN</div>
                                        <div class="text-muted" x-text="getTrafficExplorerMeta(trafficExplorer.selectedFlow.src).asn || 'Not classified'"></div>
                                        <div class="text-muted">Org</div>
                                        <div class="text-muted" x-text="getTrafficExplorerMeta(trafficExplorer.selectedFlow.src).asn_org || 'Not classified'"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="text-muted" style="font-size: 0.9em;">Destination</div>
                                    <div style="display: grid; grid-template-columns: 90px 1fr; gap: 4px 10px;">
                                        <div class="text-muted">DNS</div>
                                        <div class="text-muted" x-text="trafficExplorer.selectedFlow.dst_hostname || getTrafficExplorerMeta(trafficExplorer.selectedFlow.dst).hostname || 'Unresolved'"></div>
                                        <div class="text-muted">Geo</div>
                                        <div class="text-muted" x-text="trafficExplorer.selectedFlow.dst_country || getTrafficExplorerMeta(trafficExplorer.selectedFlow.dst).country || 'Not classified'"></div>
                                        <div class="text-muted">ASN</div>
                                        <div class="text-muted" x-text="getTrafficExplorerMeta(trafficExplorer.selectedFlow.dst).asn || 'Not classified'"></div>
                                        <div class="text-muted">Org</div>
                                        <div class="text-muted" x-text="getTrafficExplorerMeta(trafficExplorer.selectedFlow.dst).asn_org || 'Not classified'"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div style="border-top: 1px solid var(--border-soft); padding-top: var(--space-3); margin-top: var(--space-2);">
                            <div class="text-muted" style="margin-bottom: 6px;">Tags</div>
                            <div style="display: flex; flex-wrap: wrap; gap: var(--space-2);"
                                x-show="getTrafficExplorerTags(trafficExplorer.selectedFlow).length > 0">
                                <template x-for="tag in getTrafficExplorerTags(trafficExplorer.selectedFlow)" :key="tag">
                                    <span class="badge" style="background: rgba(0, 234, 255, 0.08); color: var(--text-0);"
                                        x-text="tag"></span>
                                </template>
                            </div>
                            <div class="text-muted" style="font-size: var(--text-xs);"
                                x-show="getTrafficExplorerTags(trafficExplorer.selectedFlow).length === 0">No notable tags</div>
                        </div>
                    </div>
                </div>
            </template>
            <template x-if="!trafficExplorer.selectedFlow">
                <div class="empty-state" style="text-align: center;">No flow selected. Choose a row to view details.</div>
            </template>
            {% endcall %}
        </div>
    </section>
</div>
